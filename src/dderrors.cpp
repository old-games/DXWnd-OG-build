#include <stdlib.h>
#include <string.h>
#include "dxwnd.h"


extern DWORD dwFlags;

#define MAX_ERRORS 111  
struct t_error{
    int num;
    char str[64];
};

t_error error[MAX_ERRORS] = {
0x0,        "DD_OK",
0x887602bb, "DDERR_DEVICEDOESNTOWNSURFACE",
0x80004001, "DDERR_UNSUPPORTED",
0x80004005, "DDERR_GENERIC",
0x800401f0, "DDERR_NOTINITIALIZED",
0x8007000e, "DDERR_OUTOFMEMORY",
0x80070057, "DDERR_INVALIDPARAMS",
0x88760005, "DDERR_ALREADYINITIALIZED",
0x8876000a, "DDERR_CANNOTATTACHSURFACE",
0x88760014, "DDERR_CANNOTDETACHSURFACE",
0x88760028, "DDERR_CURRENTLYNOTAVAIL",
0x88760037, "DDERR_EXCEPTION",
0x8876005a, "DDERR_HEIGHTALIGN",
0x8876005f, "DDERR_INCOMPATIBLEPRIMARY",
0x88760064, "DDERR_INVALIDCAPS",
0x8876006e, "DDERR_INVALIDCLIPLIST",
0x88760078, "DDERR_INVALIDMODE",
0x88760082, "DDERR_INVALIDOBJECT",
0x88760091, "DDERR_INVALIDPIXELFORMAT",
0x88760096, "DDERR_INVALIDRECT",
0x887600a0, "DDERR_LOCKEDSURFACES",
0x887600aa, "DDERR_NO3D",
0x887600b4, "DDERR_NOALPHAHW",
0x887600cd, "DDERR_NOCLIPLIST",
0x887600d2, "DDERR_NOCOLORCONVHW",
0x887600d4, "DDERR_NOCOOPERATIVELEVELSET",
0x887600d7, "DDERR_NOCOLORKEY",
0x887600dc, "DDERR_NOCOLORKEYHW",
0x887600de, "DDERR_NODIRECTDRAWSUPPORT",
0x887600e1, "DDERR_NOEXCLUSIVEMODE",
0x887600e6, "DDERR_NOFLIPHW",
0x887600f0, "DDERR_NOGDI",
0x887600fa, "DDERR_NOMIRRORHW",
0x887600ff, "DDERR_NOTFOUND",
0x88760104, "DDERR_NOOVERLAYHW",
0x8876010e, "DDERR_OVERLAPPINGRECTS",
0x88760118, "DDERR_NORASTEROPHW",
0x88760122, "DDERR_NOROTATIONHW",
0x88760136, "DDERR_NOSTRETCHHW",
0x8876013c, "DDERR_NOT4BITCOLOR",
0x8876013d, "DDERR_NOT4BITCOLORINDEX",
0x88760140, "DDERR_NOT8BITCOLOR",
0x8876014a, "DDERR_NOTEXTUREHW",
0x8876014f, "DDERR_NOVSYNCHW",
0x88760154, "DDERR_NOZBUFFERHW",
0x8876015e, "DDERR_NOZOVERLAYHW",
0x88760168, "DDERR_OUTOFCAPS",
0x8876017c, "DDERR_OUTOFVIDEOMEMORY",
0x8876017e, "DDERR_OVERLAYCANTCLIP",
0x88760180, "DDERR_OVERLAYCOLORKEYONLYONEACTIVE",
0x88760183, "DDERR_PALETTEBUSY",
0x88760190, "DDERR_COLORKEYNOTSET",
0x8876019a, "DDERR_SURFACEALREADYATTACHED",
0x887601a4, "DDERR_SURFACEALREADYDEPENDENT",
0x887601ae, "DDERR_SURFACEBUSY",
0x887601b3, "DDERR_CANTLOCKSURFACE",
0x887601b8, "DDERR_SURFACEISOBSCURED",
0x887601c2, "DDERR_SURFACELOST",
0x887601cc, "DDERR_SURFACENOTATTACHED",
0x887601d6, "DDERR_TOOBIGHEIGHT",
0x887601e0, "DDERR_TOOBIGSIZE",
0x887601ea, "DDERR_TOOBIGWIDTH",
0x887601fe, "DDERR_UNSUPPORTEDFORMAT",
0x88760208, "DDERR_UNSUPPORTEDMASK",
0x88760209, "DDERR_INVALIDSTREAM",
0x88760219, "DDERR_VERTICALBLANKINPROGRESS",
0x8876021c, "DDERR_WASSTILLDRAWING",
0x88760230, "DDERR_XALIGN",
0x88760231, "DDERR_INVALIDDIRECTDRAWGUID",
0x88760232, "DDERR_DIRECTDRAWALREADYCREATED",
0x88760233, "DDERR_NODIRECTDRAWHW",
0x88760234, "DDERR_PRIMARYSURFACEALREADYEXISTS",
0x88760235, "DDERR_NOEMULATION",
0x88760236, "DDERR_REGIONTOOSMALL",
0x88760237, "DDERR_CLIPPERISUSINGHWND",
0x88760238, "DDERR_NOCLIPPERATTACHED",
0x88760239, "DDERR_NOHWND",
0x8876023a, "DDERR_HWNDSUBCLASSED",
0x8876023b, "DDERR_HWNDALREADYSET",
0x8876023c, "DDERR_NOPALETTEATTACHED",
0x8876023d, "DDERR_NOPALETTEHW",
0x8876023e, "DDERR_BLTFASTCANTCLIP",
0x8876023f, "DDERR_NOBLTHW",
0x88760240, "DDERR_NODDROPSHW",
0x88760241, "DDERR_OVERLAYNOTVISIBLE",
0x88760242, "DDERR_NOOVERLAYDEST",
0x88760243, "DDERR_INVALIDPOSITION",
0x88760244, "DDERR_NOTAOVERLAYSURFACE",
0x88760245, "DDERR_EXCLUSIVEMODEALREADYSET",
0x88760246, "DDERR_NOTFLIPPABLE",
0x88760247, "DDERR_CANTDUPLICATE",
0x88760248, "DDERR_NOTLOCKED",
0x88760249, "DDERR_CANTCREATEDC",
0x8876024a, "DDERR_NODC",
0x8876024b, "DDERR_WRONGMODE",
0x8876024c, "DDERR_IMPLICITLYCREATED",
0x8876024d, "DDERR_NOTPALETTIZED",
0x8876024e, "DDERR_UNSUPPORTEDMODE",
0x8876024f, "DDERR_NOMIPMAPHW",
0x88760250, "DDERR_INVALIDSURFACETYPE",
0x88760258, "DDERR_NOOPTIMIZEHW",
0x88760259, "DDERR_NOTLOADED",
0x8876025a, "DDERR_NOFOCUSWINDOW",
0x8876026c, "DDERR_DCALREADYCREATED",
0x88760276, "DDERR_NONONLOCALVIDMEM",
0x88760280, "DDERR_CANTPAGELOCK",
0x88760294, "DDERR_CANTPAGEUNLOCK",
0x887602a8, "DDERR_NOTPAGELOCKED",
0x887602b2, "DDERR_MOREDATA",
0x887602b3, "DDERR_EXPIRED",
0x887602b7, "DDERR_VIDEONOTACTIVE"
};

char unknerror[128] = "UNKNOWN ERROR: 0x";

const char *DDError2Str(int num)
{
    char sztmp[64] = "";


    if(!(dwFlags & OUTTRACE) || !(dwFlags & HOOKDD))
        return 0;

    for(int i = 0; i < MAX_ERRORS; i++){
        if(num == error[i].num)
            return error[i].str;
    }

    ultoa(num, sztmp, 16);
    strcat(unknerror, sztmp);
    return unknerror;
}